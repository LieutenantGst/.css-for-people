<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Project Wraith</title>
  <style>
    :root {
      --p: #6366f1;
      --b: #0f0f1a;
      --c: #1a1a2e;
    }
    body {
      font-family: Inter, sans-serif;
      background: var(--b);
      color: #e2e8f0;
      margin: 0;
    }
    .container {
      max-width: 1200px;
      margin: auto;
      padding: 0 1rem;
    }
    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 700;
      transition: 0.2s;
    }
    .btn:hover {
      opacity: 0.9;
    }
    .btn-primary {
      background: var(--p);
      color: #fff;
      border: none;
    }
    .btn-outline {
      border: 2px solid var(--p);
      background: transparent;
      color: var(--p);
    }
    .card {
      background: var(--c);
      border-radius: 1rem;
      padding: 1.5rem;
      position: relative;
    }
    .ribbon {
      position: absolute;
      top: 1rem;
      right: -3rem;
      transform: rotate(45deg);
      background: #f59e0b;
      color: #000;
      padding: 0.4rem 3rem;
      font-size: 0.8rem;
      font-weight: 700;
    }
    .wide {
      width: 100%;
    }
    .paypal-button-container {
      margin-top: 1rem;
    }
  </style>
  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=YOUR_PAYPAL_CLIENT_ID&currency=USD"></script>
</head>
<body>
  <header style="padding:1rem 0;position:sticky;top:0;background:rgba(15,15,26,.9);backdrop-filter:blur(10px);z-index:10">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center">
      <div style="display:flex;gap:.5rem;align-items:center;color:#fff;text-decoration:none">
        <svg width="36" height="36" viewBox="0 0 36 36">
          <circle cx="18" cy="18" r="16" fill="none" stroke="#60a5fa" stroke-width="2"/>
          <text x="18" y="24" font-size="20" fill="#6ee7b7" text-anchor="middle" font-weight="800">W</text>
        </svg>
        <span style="font-weight:800;font-size:1.3rem">Project Wraith</span>
      </div>
      <button id="discordBtn" class="btn btn-outline">Connect Discord</button>
    </div>
  </header>

  <main class="container" id="main" style="padding:4rem 0;">
    <h1 style="font-size:3rem;text-align:center">Donate = Instant Role</h1>
    <p style="text-align:center;font-size:1.2rem;color:#94a3b8">
      Click Connect → Choose Pack → Role appears in 1 sec
    </p>

    <div id="packs" style="display:grid;gap:2rem;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));margin-top:3rem">
      <!-- STARTER -->
      <div class="card">
        <h3>Starter Pack – $5</h3>
        <ul style="list-style:none;padding:0;margin:1rem 0;">
          <li>✔ Donor chat</li>
          <li>✔ Starter role</li>
          <li>✔ Priority Support</li>
        </ul>
        <div id="paypal-starter" class="paypal-button-container"></div>
      </div>

      <!-- FOUNDER -->
      <div class="card">
        <div class="ribbon">POPULAR</div>
        <h3>Founder Pack – $10</h3>
        <ul style="list-style:none;padding:0;margin:1rem 0;">
          <li>✔ Everything in Starter</li>
          <li>✔ Gold Founder badge</li>
          <li>✔ Name changes</li>
        </ul>
        <div id="paypal-founder" class="paypal-button-container"></div>
      </div>

      <!-- ULTIMATE -->
      <div class="card">
        <h3>Ultimate Donator – $15</h3>
        <ul style="list-style:none;padding:0;margin:1rem 0;">
          <li>✔ Full Locker</li>
          <li>✔ Private VC</li>
          <li>✔ Everything from above packs</li>
        </ul>
        <div id="paypal-ultimate" class="paypal-button-container"></div>
      </div>
    </div>
  </main>

  <script>
    const BOT_API = "https://3b825c63.wispbyte.com";
    const CLIENT_ID = "1435865601196294204";
    const REDIRECT = encodeURIComponent(window.location.origin + window.location.pathname);
    const discordBtn = document.getElementById("discordBtn");

    // Connect Discord
    discordBtn.onclick = () => {
      if (localStorage.discordId) {
        localStorage.clear();
        location.reload();
        return;
      }
      const url = `https://discord.com/oauth2/authorize?client_id=${CLIENT_ID}&redirect_uri=${REDIRECT}&response_type=token&scope=identify`;
      window.location.href = url;
    };

    // Handle OAuth redirect
    if (location.hash.includes("access_token")) {
      const token = new URLSearchParams(location.hash.slice(1)).get("access_token");
      fetch("https://discord.com/api/users/@me", {
        headers: { Authorization: `Bearer ${token}` }
      })
        .then(r => r.json())
        .then(u => {
          localStorage.discordId = u.id;
          localStorage.discordTag = u.username;
          discordBtn.textContent = `Connected: ${u.username}`;
          discordBtn.style.background = "transparent";
          discordBtn.style.color = "#fff";
          discordBtn.style.border = "2px solid var(--p)";
          history.replaceState({}, "", location.pathname);
        })
        .catch(() => alert("Failed to connect Discord"));
    }

    // Show connected on page load
    if (localStorage.discordId) {
      discordBtn.textContent = `Connected: ${localStorage.discordTag}`;
      discordBtn.style.background = "transparent";
      discordBtn.style.color = "#fff";
      discordBtn.style.border = "2px solid var(--p)";
    }

    // PayPal Buttons
    function renderPayPalButton(containerId, amount, pack) {
      paypal.Buttons({
        style: { layout: 'horizontal', color: 'blue', shape: 'rect', label: 'paypal' },
        createOrder: function(data, actions) {
          if (!localStorage.discordId) {
            alert("Connect Discord first!");
            return;
          }
          return actions.order.create({
            purchase_units: [{ amount: { value: amount } }]
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            // Call your backend after successful payment
            fetch(`${BOT_API}/give`, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({
                userId: localStorage.discordId,
                pack: pack
              })
            })
              .then(res => res.text())
              .then(text => alert("Payment successful! " + text))
              .catch(e => alert("Something went wrong: " + e.message));
          });
        }
      }).render(`#${containerId}`);
    }

    // Render buttons for each pack
    renderPayPalButton("paypal-starter", "5.00", "Starter");
    renderPayPalButton("paypal-founder", "10.00", "Founder");
    renderPayPalButton("paypal-ultimate", "15.00", "Ultimate");
  </script>
</body>
</html>
